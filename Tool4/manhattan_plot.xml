<tool id="manhattan_plot" name="Manhattan Plot Generator" version="1.0.0">
    <description>Create a Manhattan plot from GWAS results</description>
    <command>
        <![CDATA[
        python '$__tool_directory__/manhattan_plot.py'
        '$assoc_results'
        '$output_dir'
        '$p_threshold'
        '$top_n'
        ]]>
    </command>
    <inputs>
        <param name="assoc_results" type="data" format="tsv" label="Association Results (from Tool 3)"/>
        <param name="p_threshold" type="float" value="5e-8" label="P-value Significance Threshold"/>
        <param name="top_n" type="integer" value="20" label="Number of Top Hits to Report"/>
    </inputs>
    <outputs>
        <data name="output_plot" format="png" from_work_dir="sample_outputs/manhattan_plot.png" label="Manhattan Plot"/>
        <data name="output_top_hits" format="tsv" from_work_dir="sample_outputs/top_hits.tsv" label="Top ${top_n} GWAS Hits"/>
    </outputs>
    <help>
        **Input Requirements:**
        - Association results must contain: snp_id, chrom, pos, p_value

        **Outputs:**
        - PNG: Manhattan plot with significance threshold
        - TSV: Top N most significant SNPs
    </help>
    <requirements>
        <requirement type="package" version="3.4.3">matplotlib</requirement>
        <requirement type="package" version="1.3.0">pandas</requirement>
        <requirement type="package" version="1.21.0">numpy</requirement>
    </requirements>
</tool>