<tool id="logistic_regression" name="GWAS Logistic Regression" version="2.0.0">
    <command>
        python logistic_regression.py
        "$genotypes"
        "$phenotypes"
        "$output_tsv"
        "$covariates"
        "$maf_thresh"
        "$missing_code"
        "$snp_annotation"  <!-- Now REQUIRED -->
    </command>
    <inputs>
        <param name="genotypes" type="data" format="tsv" label="Genotypes TSV"/>
        <param name="phenotypes" type="data" format="tsv" label="Phenotypes TSV"/>
        <param name="snp_annotation" type="data" format="tsv" label="SNP Annotation TSV (must contain: chrom, pos, maf)"/>
        <param name="covariates" type="text" value="age,sex" label="Covariates (comma-separated)"/>
        <param name="maf_thresh" type="float" value="0.01" label="MAF Threshold"/>
        <param name="missing_code" type="text" value="NA" label="Missing Value Code"/>
    </inputs>
    <outputs>
        <data name="output_tsv" format="tsv" label="Association Results"/>
    </outputs>
    <help>
        **Input Requirements:**
        - SNP annotation must include: snp_id, chrom, pos, maf.
        - Genotypes: 0/1/2 coded, samples Ã— SNPs.
        - Phenotypes: binary (0/1) with covariates.
    </help>
</tool>
    <description>Perform logistic regression for GWAS analysis.</description>
    <requirements>
        <requirement type="package" version="1.0">numpy</requirement>
        <requirement type="package" version="1.0">pandas</requirement>
        <requirement type="package" version="1.0">statsmodels</requirement>
    </requirements>